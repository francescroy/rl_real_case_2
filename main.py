

import numpy as np
from random import *
import math
import time
import sys
import matplotlib.pyplot as plt

X_SIZE =7 # 5,7,9
Y_SIZE =7 # 5,7,9
NUM_STATES = X_SIZE * Y_SIZE
GAMMA = 0.90
OPTIMAL_X, OPTIMAL_Y = 3,3 # 2,3,4
OPTIMAL_FINAL_STATE = False # Can be false if using TD-learning or DP methods but must be true if some MonteCarlo method...
COST_STEP = 0.10
NUM_ACTIONS = 5

ROUND_COUNTER = 0 # in seconds
TOTAL_ROUND_COUNTER = 0 # in seconds
TOTAL_PRICE = 0 # in euros
ID_USER = 0

CPU_TYPE_1 = 1
CPU_TYPE_2 = 5
MAX_JBS = 10 # (5 or 10 default)
PRICE_JB_S = 0.000025 # 0.000025 default :0.09$ la hora (based on real Amazon EC2...)
PRICE_SLA_S = 0.0025 # 0.0025 default :9$ la hora
CPU_LOAD_SLA = 70 # mean

CYCLE_IN_SECONDS = int(sys.argv[1]) # in seconds
PATTERN = int(sys.argv[3])
PHOTO_INTERVAL = 5 # in seconds (1 or 5 default)
DURACIO_VID = 120 # in seconds
DURACIO_VID_MIN = 110
DURACIO_VID_MAX = 130

ALPHA = 0.15
QUANTIZATION_TIME = 20 # default 10
QUANTIZATION_CPU = 20 # default 10
NUM_EXP = 10
TOTAL_EXP = 0

horari = [None] * CYCLE_IN_SECONDS # Al principi es una llista de None's.
                                   # Es regenera a cada cycle.
                                   # Cada element es o None o una list de mini-lists de 2...

# random numbers from 15 to CYCLE_IN_SECONDS - 15
random_numbers=[]
if CYCLE_IN_SECONDS == 600:
    if PATTERN==1:
        random_numbers = [119, 178, 159, 194, 355, 461, 554, 20, 552, 203, 428, 482, 570, 243, 426, 263, 463, 236, 20, 131, 37, 311, 223, 367, 120, 116, 375, 25, 162, 165, 267, 300, 419, 29, 543, 422, 261, 181, 336, 214, 279, 371, 355, 551, 471, 255, 331, 457, 284, 514, 374, 161, 134, 578, 150, 440, 492, 107, 181, 176, 576, 99, 41, 107, 156, 479, 101, 168, 461, 164, 148, 448, 367, 263, 535, 82, 483, 245, 502, 213, 368, 40, 65, 155, 275, 88, 431, 351, 48, 154, 19, 522, 252, 296, 414, 81, 447, 426, 376, 509, 570, 240, 208, 470, 584, 291, 101, 286, 467, 236, 571, 536, 268, 33, 562, 479, 50, 505, 370, 115, 282, 545, 85, 348, 557, 511, 37, 91, 434, 316, 419, 429, 170, 201, 199, 524, 318, 390, 126, 42, 96, 328, 332, 575, 111, 531, 152, 16, 503, 179, 284, 291, 158, 177, 21, 406, 504, 408, 236, 264, 71, 147, 130, 159, 476, 190, 382, 458, 156, 88, 88, 20, 45, 311, 36, 428, 228, 86, 349, 272, 187, 192, 405, 143, 561, 96, 64, 217, 482, 291, 457, 257, 334, 399, 420, 379, 77, 357, 138, 117, 259, 584, 140, 572, 334, 217, 366, 193, 283, 494, 546, 94, 402, 432, 87, 115, 48, 230, 177, 40, 531, 533, 584, 245, 521, 38, 64, 93, 136, 575, 430, 314, 379, 174, 186, 96, 179, 135, 181, 313, 500, 569, 129, 349, 215, 367, 466, 94, 276, 71, 341, 422, 179, 52, 263, 522, 472, 160, 271, 407, 261, 265, 173, 297, 403, 241, 383, 406, 70, 177, 542, 159, 25, 78, 361, 458, 136, 310, 73, 104, 493, 158, 521, 80, 469, 408, 544, 373, 314, 573, 210, 264, 105, 259, 558, 316, 262, 486, 498, 448, 49, 338, 243, 245, 333, 113, 519, 541, 556, 105, 483, 120, 133, 206, 519, 383, 523, 207, 86, 489, 456, 358, 470, 369, 168, 223, 131, 247, 130, 338, 274, 247, 192, 177, 476, 332, 540, 180, 526, 182, 435, 507, 498, 302, 105, 25, 335, 137, 491, 74, 347, 331, 493, 34, 286, 255, 52, 133, 89, 374, 223, 57, 224, 312, 178, 541, 92, 565, 562, 411, 186, 266, 184, 322, 565, 254, 421, 378, 194, 301, 378, 253, 148, 282, 176, 112, 144, 46, 49, 218, 496, 273, 77, 304, 37, 228, 358, 38, 78, 191, 538, 134, 441, 323, 292, 399, 498, 131, 231, 576, 198, 42, 541, 572, 510, 158, 443, 320, 124, 142, 393, 551, 398, 578, 212, 371, 93, 356, 217, 93, 314, 52, 526, 113, 414, 157, 109, 100, 564, 260, 16, 577, 142, 580, 467, 109, 585, 277, 361, 356, 535, 233, 285, 274, 52, 17, 349, 74, 297, 247, 252, 219, 237, 555, 455, 110, 149, 394, 155, 248, 521, 211, 398, 419, 400, 240, 73, 256, 580, 312, 59, 378, 393, 23, 234, 143, 156, 61, 443, 358, 550, 406, 426, 207, 286, 414, 491, 129, 567, 263, 478, 81, 424, 279, 29, 147, 359, 355, 584, 500, 76, 278, 60, 492, 531, 324, 280, 501, 79, 446, 486, 150, 153, 307, 185, 530, 563, 474, 179, 431, 293, 530, 85, 115, 208, 480, 431, 547, 505, 383, 418, 345, 112, 198, 469, 465, 139, 202, 133, 237, 241, 266, 74, 246, 359, 585, 85, 219, 391, 350, 160, 215, 454, 144, 459, 446, 537, 36, 332, 157, 76, 189, 329, 133, 540, 147, 558, 182, 75, 250, 540, 99, 447, 61, 65, 403, 211, 113, 75, 94, 194, 441, 133, 237, 182, 437, 66, 317, 290, 556, 158, 490, 324, 137, 434, 374, 319, 468, 317, 196, 566, 171, 255, 329, 476, 240, 380, 484, 42, 305, 124, 479, 486, 50, 229, 257, 397, 254, 109, 371, 340, 243, 36, 57, 202, 509, 419, 415, 241, 421, 106, 380, 154, 87, 569, 171, 249, 571, 265, 556, 164, 458, 201, 463, 189, 359, 181, 547, 353, 325, 105, 528, 516, 563, 84, 316, 572, 206, 542, 415, 572, 277, 148, 357, 119, 181, 279, 238, 280, 449, 161, 86, 321, 287, 286, 34, 348, 463, 364, 319, 298, 479, 524, 285, 351, 178, 178, 164, 560, 252, 572, 178, 15, 541, 336, 259, 114, 451, 562, 39, 112, 207, 131, 233, 425, 325, 460, 16, 459, 169, 159, 378, 359, 202, 543, 186, 317, 460, 522, 422, 461, 490, 567, 542, 515, 357, 540, 579, 326, 282, 155, 418, 337, 398, 537, 274, 469, 444, 172, 556, 276, 522, 549, 550, 532, 217, 553, 32, 344, 87, 43, 143, 110, 75, 173, 90, 256, 396, 350, 207, 101, 372, 109, 332, 267, 469, 32, 364, 349, 90, 145, 259, 497, 184, 191, 429, 382, 109, 525, 16, 288, 431, 61, 555, 539, 315, 403, 146, 126, 259, 217, 427, 187, 276, 411, 418, 450, 437, 181, 307, 336, 489, 482, 289, 158, 20, 330, 235, 193, 110, 504, 59, 155, 401, 585, 189, 173, 282, 399, 352, 147, 180, 138, 422, 28, 113, 82, 530, 236, 458, 501, 220, 556, 318, 478, 533, 44, 298, 137, 228, 514, 510, 279, 127, 315, 136, 308, 264, 558, 194, 64, 62, 376, 174, 369, 256, 434, 487, 413, 217, 545, 113, 523, 366, 120, 379, 139, 168, 109, 331, 117, 237, 299, 221, 465, 218, 349, 545, 154, 444, 577, 98, 489, 497, 532, 111, 381, 184, 376, 498, 77, 329, 133, 296, 348, 55, 277, 155, 436, 165, 305, 133, 285, 478, 37, 464, 317, 80, 364, 209, 295, 111, 243, 252, 399, 566, 550, 525, 158, 193, 400, 76, 322, 346, 343, 265, 181, 386, 39, 197, 56, 127, 509, 28, 223, 197, 240, 33, 16, 272, 70, 551, 365, 272, 499, 416, 205, 480, 524, 27, 103, 396, 236, 413, 224, 326, 540, 111, 292, 357, 303, 308, 212, 512, 488, 476, 512, 46, 273, 22, 218, 119, 233, 332, 158, 394, 569, 306, 517, 108, 562, 439, 367, 429, 255, 499, 235, 368, 89, 64, 254, 40, 480, 225, 268, 104, 397, 102, 488, 241, 282, 393, 265, 357, 577, 266, 122, 343, 233, 248, 199, 177, 302, 249, 524, 186, 566, 131, 332, 488, 258, 419, 561, 238, 363, 458, 76, 144, 504, 65, 414, 343, 54, 318, 140, 291, 384, 570, 534, 490, 58, 150, 370, 421, 501, 118, 275, 461, 197, 41, 572, 372, 153, 506, 546, 182, 62, 283, 84, 431, 375, 97, 260, 152, 69, 36, 335, 132, 520, 145, 87, 306, 392, 265, 509, 519, 95, 437, 115, 207, 23, 151, 232, 523, 446, 135, 493, 228, 416, 584, 25, 20, 564, 138, 188, 387, 491, 107, 183, 141, 69, 420, 289, 162, 76, 438, 465, 419, 112, 494, 100, 489, 175, 67, 306, 541, 111, 43, 125, 87, 302, 398, 411, 384, 351, 515, 341, 575, 90, 323, 388, 528, 516, 133, 439, 285, 464, 69, 224, 487, 239, 352, 282, 131, 27, 255, 422, 181, 494, 156, 73, 47, 535, 109, 462, 432, 438, 396, 57, 153, 400, 94, 192, 47, 426, 142, 377, 277, 335, 223, 549, 568, 193, 104, 18, 319, 37, 191, 109, 162, 237, 330, 474, 548, 276, 248, 52, 107, 385, 109, 19, 196, 80, 103, 520, 340, 108, 143, 352, 172, 36, 114, 352, 254, 261, 484, 176, 55, 394, 431, 338, 203, 175, 110, 255, 221, 473, 215, 543, 149, 570, 295, 563, 548, 196, 213, 100, 434, 264, 408, 440, 327, 417, 379, 250, 21, 264, 169, 560, 356, 488, 550, 123, 364, 309, 371, 486, 374, 63, 133, 346, 20, 517, 565, 437, 123, 395, 570, 229, 219, 109, 424, 207, 108, 308, 432, 314, 440, 201, 409, 469, 202, 354, 138, 333, 584, 155, 61, 75, 315, 581, 89, 428, 249, 262, 106, 113, 210, 482, 154, 388, 551, 563, 323, 79, 319, 317, 549, 355, 137, 480, 439, 205, 436, 63, 261, 96, 109, 400, 481, 286, 267, 177, 371, 451, 268, 59, 93, 475, 106, 410, 185, 353, 204, 571, 430, 355, 90, 176, 541, 332, 435, 523, 376, 111, 196, 443, 420, 324, 485, 349, 422, 40, 260, 565, 148, 454, 295, 194, 427, 270, 36, 149, 482, 367, 284, 321, 124, 346, 121, 436, 219, 407, 292, 46, 348, 284, 241, 370, 143, 496, 289, 284, 359, 79, 172, 406, 314, 43, 432, 428, 59, 149, 133, 73, 125, 528, 208, 453, 474, 220, 193, 140, 227, 245, 131, 88, 190, 117, 550, 93, 566, 469, 140, 471, 309, 367, 106, 55, 119, 561, 583, 351, 530, 551, 62, 213, 386, 144, 259, 318, 286, 397, 379, 305, 583, 245, 335, 373, 53, 170, 331, 271, 352, 118, 470, 499, 158, 219, 415, 58, 119, 429, 414, 467, 532, 488, 300, 337, 369, 335, 66, 485, 242, 382, 190, 472, 179, 476, 487, 64, 393, 17, 95, 403, 87, 518, 176, 142, 457, 306, 200, 46, 82, 249, 323, 322, 503, 446, 473, 460, 564, 175, 456, 411, 297, 524, 256, 63, 394, 428, 164, 364, 299, 456, 289, 487, 279, 71, 429, 356, 32, 200, 228, 318, 483, 327, 432, 280, 156, 540, 418, 472, 178, 170, 189, 158, 110, 63, 527, 27, 283, 266, 389, 34, 227, 93, 188, 208, 376, 548, 445, 90, 201, 564, 300, 483, 310, 198, 138, 254, 433, 517, 24, 455, 273, 141, 337, 174, 349, 17, 435, 138, 334, 579, 520, 236, 269, 81, 219, 514, 69, 578, 32, 312, 396, 365, 535, 485, 123, 291, 471, 109, 516, 529, 71, 333, 352, 163, 438, 312, 67, 388, 439, 512, 82, 53, 126, 94, 214, 567, 579, 554, 68, 115, 483, 403, 209, 145, 178, 429, 284, 512, 75, 369, 146, 417, 383, 71, 260, 118, 169, 409, 49, 244, 119, 91, 153, 514, 399, 35, 330, 411, 311, 350, 18, 134, 79, 84, 565, 153, 554, 540, 489, 193, 469, 283, 122, 433, 581, 478, 290, 162, 473, 202, 362, 464, 81, 230, 266, 296, 125, 116, 99, 203, 500, 473, 273, 54, 62, 36, 68, 526, 570, 158, 400, 583, 416, 209, 280, 503, 247, 210, 413, 449, 264, 177, 562, 426, 43, 359, 357, 486, 572, 330, 422, 544, 229, 529, 373, 204, 448, 155, 347, 262, 228, 393, 170, 551, 491, 346, 120, 122, 117, 478, 158, 316, 532, 462, 348, 278, 553, 454, 312, 163, 531, 476, 441, 53, 266, 364, 460, 178, 67, 222, 104, 127, 474, 197, 480, 52, 210, 474, 23, 219, 328, 295, 316, 193, 45, 298, 56, 35, 290, 408, 132, 82, 155, 370, 508, 40, 177, 516, 126, 308, 177, 65, 303, 494, 301, 327, 564, 305, 219, 261, 542, 271, 93, 583, 175, 56, 32, 579, 367, 492, 527, 174, 546, 338, 529, 247, 340, 410, 570, 188, 281, 120, 139, 85, 66, 231, 99, 99, 56, 59, 152, 335, 147, 523, 553, 120, 113, 563, 503, 406, 189, 290, 62, 426, 111, 26, 117, 141, 277, 93, 74, 181, 375, 500, 488, 361, 343, 406, 360, 546, 83, 204, 117, 567, 550, 315, 98, 454, 311, 552, 96, 501, 244, 509, 544, 425, 498, 41, 167, 440, 27, 532, 220, 266, 214, 541, 339, 38, 186, 323, 287, 157, 262, 21, 219, 246, 29, 182, 87, 545, 341, 403, 390, 239, 43, 202, 534, 547, 238, 201, 159, 435, 234, 294, 427, 129, 573, 50, 341, 67, 43, 287, 41, 151, 387, 425, 94, 142, 461, 323, 271, 441, 579, 348, 152, 195, 268, 576, 299, 394, 566, 212, 145, 54, 28, 275, 259, 55, 529, 116, 515, 435, 252, 69, 261, 257, 570, 169, 180, 274, 38, 286, 80, 519, 61, 461, 493, 517, 23, 19, 54, 388, 362, 222, 91, 373, 87, 201, 266, 236, 98, 236, 299, 533, 566, 396, 32, 305, 200, 257, 475, 544, 582, 134, 218, 108, 489, 378, 133, 462, 487, 343, 416, 473, 377, 454, 550, 300, 158, 98, 206, 524, 561, 512, 289, 213, 174, 298, 466, 421, 31, 153, 108, 526, 309, 140, 200, 529, 113, 161, 439, 154, 101, 241, 210, 44, 189, 362, 535, 319, 551, 52, 215, 199, 365, 206, 271, 76, 311, 107, 568, 143, 518, 355, 148, 117, 542, 225, 206, 427, 150, 528, 67, 545, 557, 276, 441, 571, 327, 24, 53, 179, 184, 212, 515, 455, 564, 488, 235, 333, 72, 34, 202, 275, 438, 270, 332, 269, 526, 408, 511, 19, 275, 310, 158, 278, 206, 81, 15, 38, 280, 548, 558, 307, 480, 556, 342, 30, 310, 107, 137, 309, 167, 332, 333, 160, 494, 466, 284, 351, 171, 237, 474, 468, 71, 307, 183, 532, 549, 429, 464, 226, 382, 503, 547, 523, 26, 217, 160, 36, 427, 471, 450, 100, 222, 433, 495, 278, 154, 121, 19, 380, 532, 56, 275, 134, 178, 143, 142, 267, 233, 569, 501, 394, 513, 325, 218, 397, 560, 485, 78, 390, 194, 240, 547, 255, 90, 461, 498, 489, 192, 552, 365, 73, 309, 262, 124, 523, 506, 193, 581, 551, 410, 231, 360, 337, 279, 141, 257, 437, 553, 72, 257, 363, 543, 529, 575, 535, 188, 202, 247, 554, 273, 380, 232, 317, 40, 59, 369, 397, 415, 511, 552, 133, 20, 332, 398, 403, 353, 97, 346, 383, 56, 249, 556, 204, 39, 338, 578, 561, 192, 370, 197, 244, 348, 516, 283, 324, 150, 83, 219, 19, 451, 151, 464, 497, 240, 141, 413, 318, 366, 91, 505, 94, 434, 181, 347, 488, 325, 102, 166, 496, 403, 426, 389, 354, 475, 393, 228, 26, 393, 317, 574, 461, 432, 190, 472, 470, 489, 98, 446, 17, 400, 292, 364, 174, 584, 504, 348, 399, 507, 467, 507, 341, 407, 242, 530, 68, 55, 155, 201, 166, 168, 258, 418, 361, 320, 197, 388, 319, 485, 33, 26, 474, 144, 299, 28, 261, 468, 161, 565, 342, 218, 156, 389, 261, 216, 374, 302, 136, 419, 85, 274, 71, 107, 27, 387, 199, 195, 486, 100, 470, 582, 489, 234, 227, 413, 219, 341, 244, 572, 392, 550, 467, 200, 94, 511, 146, 216, 280, 439, 583, 388, 85, 105, 43, 57, 350, 352, 445, 94, 213, 520, 58, 43, 414, 304, 405, 353, 264, 509, 97, 158, 284, 500, 260, 113, 441, 179, 231, 231, 132, 103, 261, 320, 148, 379, 530, 148, 130, 57, 388, 268, 444, 289, 519, 160, 577, 574, 18, 412, 45, 492, 340, 152, 280, 73, 412, 72, 310, 53, 412, 438, 469, 338, 503, 352, 399, 482, 346, 231, 58, 263, 561, 565, 463, 575, 511, 442, 442, 372, 426, 575, 47, 162, 336, 465, 340, 224, 477, 25, 407, 402, 36, 404, 517, 566, 393, 364, 26, 444, 169, 447, 267, 529, 512, 145, 285, 221, 92, 247, 352, 270, 354, 241, 100, 176, 522, 122, 412, 269, 56, 123, 531, 123, 510, 545, 559, 418, 205, 135, 489, 475, 40, 289, 205, 249, 135, 470, 133, 82, 132, 369, 35, 220, 219, 121, 502, 252, 495, 222, 138, 164, 311, 93, 371, 406, 472, 267, 169, 399, 493, 512, 188, 429, 505, 529, 481, 180, 291, 542, 85, 40, 93, 248, 494, 288, 136, 37, 214, 361, 137, 438, 465, 139, 325, 190, 205, 50, 297, 549, 126, 165, 475, 453, 226, 172, 154, 21, 99, 264, 16, 395, 321, 105, 279, 366, 391, 182, 408, 217, 429, 383, 237, 452, 375, 153, 94, 31, 485, 428, 485, 226, 126, 328, 306, 187, 229, 108, 316, 89, 218, 520, 89, 428, 442, 524, 441, 186, 134, 121, 247, 22, 448, 169, 200, 289, 330, 566, 504, 444, 551, 585, 184, 269, 533, 449, 496, 494, 507, 23, 214, 112, 492, 410, 91, 194, 432, 520, 118, 160, 81, 513, 562, 165, 204, 379, 441, 311, 18, 567, 240, 282, 69, 533, 574, 443, 418, 102, 37, 281, 257, 500, 58, 100, 450, 428, 468, 505, 456, 356, 138, 228, 425, 235, 222, 225, 557, 48, 87, 238, 578, 16, 295, 276, 195, 103, 157, 234, 328, 244, 439, 244, 335, 124, 309, 182, 315, 539, 571, 334, 258, 212, 359, 215, 349, 120, 346, 302, 382, 438, 57, 327, 472, 142, 195, 563, 253, 204, 119, 494, 68, 380, 265, 33, 55, 227, 391, 492, 280, 390, 120, 52, 258, 260, 584, 408, 221, 62, 69, 375, 264, 30, 460, 368, 355, 503, 92, 421, 200, 344, 324, 45, 544, 96, 59, 86, 468, 446, 433, 410, 365, 166, 42, 357, 368, 99, 118, 201, 569, 177, 149, 554, 164, 160, 533, 431, 80, 367, 196, 101, 565, 527, 147, 355, 131, 270, 438, 413, 118, 462, 121, 290, 292, 223, 371, 285, 281, 200, 428, 429, 31, 400, 513, 475, 114, 529, 507, 516, 89, 307, 474, 454, 387, 475, 181, 64, 189, 76, 162, 96, 505, 517, 32, 104, 224, 438, 520, 240, 305, 425, 487, 56, 472, 281, 470, 154, 475, 350, 455, 444, 463, 444, 205, 489, 127, 145, 429, 453, 503, 16, 327, 410, 122, 354, 549, 387, 56, 414, 384, 267, 16, 353, 542, 374, 486, 481, 152, 342, 164, 544, 220, 163, 98, 151, 516, 203, 295, 45, 414, 79, 200, 247, 25, 423, 80, 220, 81, 266, 573, 293, 534, 583, 141, 418, 429, 290, 391, 564, 519, 15, 398, 266, 146, 291, 473, 207, 201, 534, 348, 313, 50, 157, 582, 416, 547, 467, 243, 207, 462, 432, 543, 499, 408, 78, 326, 203, 165, 491, 173, 540, 271, 469, 201, 96, 384, 48, 431, 458, 438, 287, 203, 161, 255, 347, 170, 385, 243, 307, 254, 174, 116, 547, 333, 380, 193, 565, 556, 127, 539, 430, 50, 76, 397, 69, 330, 149, 129, 272, 131, 298, 425, 488, 338, 391, 305, 298, 122, 521, 447, 253, 276, 115, 90, 77, 373, 118, 45, 557, 509, 422, 24, 219, 175, 395, 540, 109, 81, 536, 47, 254, 117, 561, 277, 471, 38, 555, 136, 191, 568, 203, 343, 120, 291, 307, 148, 234, 18, 174, 243, 122, 292, 56, 393, 407, 497, 347, 69, 171, 406, 301, 100, 176, 454, 391, 501, 283, 187, 103, 86, 537, 136, 429, 355, 410, 380, 28, 423, 562, 151, 154, 539, 224, 450, 142, 153, 91, 373, 98, 442, 171, 168, 326, 288, 310, 69, 348, 130, 89, 513, 233, 452, 475, 187, 41, 402, 441, 314, 305, 305, 34, 122, 58, 367, 82, 137, 123, 489, 501, 116, 216, 434, 311, 408, 296, 392, 183, 550, 36, 276, 22, 524, 73, 186, 308, 366, 454, 245, 434, 322, 246, 437, 423, 127, 83, 528, 170, 174, 157, 197, 98, 472, 39, 287, 356, 252, 18, 248, 243, 35, 42, 257, 351, 507, 154, 203, 382, 177, 463, 60, 147, 184, 510, 92, 129, 434, 345, 542, 472, 114, 490, 392, 209, 294, 369, 366, 341, 509, 236, 159, 452, 325, 137, 416, 483, 209, 314, 285, 381, 442, 182, 526, 274, 377, 466, 408, 240, 448, 268, 199, 164, 88, 518, 580, 286, 153, 291, 565, 291, 400, 64, 513, 105, 72, 350, 104, 549, 302, 410, 141, 349, 224, 570, 191, 280, 340, 585, 47, 496, 173, 95, 206, 335, 388, 373, 154, 29, 484, 34, 184, 142, 86, 296, 208, 430, 192, 572, 250, 265, 439, 420, 366, 410, 392, 153, 116, 293, 320, 473, 323, 180, 68, 533, 101, 543, 53, 459, 363, 72, 460, 76, 332, 80, 83, 347, 546, 172, 101, 108, 253, 70, 86, 522, 224, 423, 359, 250, 582, 361, 82, 284, 179, 435, 94, 312, 513, 244, 287, 255, 328, 540, 189, 41, 238, 78, 329, 104, 523, 211, 579, 445, 552, 395, 294, 396, 437, 69, 208, 337, 156, 69, 36, 49, 271, 32, 405, 395, 215, 555, 216, 491, 546, 542, 94, 175, 576, 126, 477, 338, 338, 535, 86, 190, 244, 101, 173, 443, 386, 179, 530, 314, 91, 46, 390, 212, 187, 572, 227, 281, 24, 234, 181, 54, 72, 56, 339, 307, 335, 146, 282, 282, 346, 266, 578, 506, 304, 161, 312, 135, 454, 302, 288, 116, 35, 261, 206, 23, 536, 478, 116, 145, 407, 28, 296, 435, 253, 573, 75, 17, 286, 60, 269, 483, 101, 471, 505, 305, 537, 576, 242, 424, 345, 549, 250, 350, 205, 217, 359, 185, 561, 576, 503, 491, 387, 475, 472, 163, 382, 300, 523, 274, 286, 193, 477, 324, 341, 405, 293, 150, 33, 388, 502, 140, 299, 46, 339, 353, 532, 528, 551, 42, 278, 204, 542, 194, 351, 156, 372, 30, 368, 531, 444, 130, 539, 371, 200, 415, 197, 476, 463, 336, 582, 25, 380, 210, 479, 433, 464, 432, 49, 61, 554, 503, 384, 420, 191, 422, 260, 285, 496, 133, 280, 241, 470, 462, 413, 221, 246, 137, 110, 172, 468, 544, 421, 235, 451, 290, 396, 130, 249, 309, 422, 521, 180, 74, 356, 304, 484, 187, 521, 388, 168, 276, 101, 308, 184, 540, 232, 129, 368, 585, 97, 17, 459, 52, 83, 416, 268, 412, 363, 391, 398, 549, 107, 533, 390, 255, 549, 434, 533, 385, 375, 44, 175, 257, 29, 140, 168, 90, 298, 572, 532, 41, 310, 154, 413, 353, 332, 288, 114, 406, 193, 503, 349, 261, 333, 391, 144, 82, 195, 514, 241, 154, 308, 332, 521, 375, 261, 490, 97, 211, 436, 165, 528, 474, 538, 438, 168, 403, 100, 264, 336, 299, 182, 58, 209, 247, 221, 373, 301, 59, 129, 141, 326, 227, 519, 267, 222, 69, 233, 551, 427, 61, 23, 315, 177, 184, 360, 459, 281, 29, 308, 15, 418, 524, 90, 41, 514, 264, 325, 547, 443, 62, 396, 577, 460, 241, 216, 362, 155, 167, 437, 420, 153, 163, 544, 532, 127, 145, 378, 167, 365, 40, 22, 84, 111, 262, 550, 331, 384, 231, 28, 85, 160, 22, 289, 341, 307, 475, 88, 116, 525, 247, 438, 534, 59, 328, 373, 165, 584, 237, 546, 525, 91, 456, 550, 32, 374, 578, 283, 348, 327, 167, 489, 278, 97, 67, 405, 552, 415, 264, 414, 271, 95, 288, 251, 195, 34, 570, 103, 416, 125, 474, 181, 573, 273, 47, 418, 555, 260, 227, 530, 537, 41, 362, 19, 110, 216, 257, 249, 239, 262, 357, 539, 367, 233, 427, 443, 401, 30, 408, 163, 161, 457, 373, 179, 40, 128, 365, 347, 571, 18, 35, 335, 580, 568, 184, 102, 204, 557, 18, 133, 564, 341, 289, 281, 103, 445, 290, 563, 29, 487, 571, 95, 364, 243, 117, 373, 573, 137, 542, 561, 46, 198, 174, 25, 127, 312, 219, 481, 483, 317, 580, 176, 181, 491, 561, 348, 189, 278, 513, 235, 392, 398, 553, 522, 543, 209, 161, 197, 434, 274, 472, 153, 351, 121, 131, 571, 168, 553, 502, 302, 115, 464, 581, 275, 447, 460, 334, 557, 114, 195, 331, 20, 468, 86, 446, 80, 33, 97, 109, 467, 192, 164, 235, 553, 434, 381, 539, 533, 306, 187, 457, 148, 370, 397, 296, 231, 68, 223, 64, 84, 571, 170, 481, 45, 424, 506, 498, 358, 403, 558, 468, 430, 449, 308, 117, 57, 190, 507, 323, 121, 135, 463, 231, 150, 133, 38, 336, 69, 414, 204, 38, 192, 58, 97, 373, 451, 61, 64, 302, 148, 452, 66, 348, 176, 40, 388, 347, 261, 40, 389, 223, 235, 542, 15, 202, 162, 528, 95, 167, 556, 288, 423, 306, 526, 389, 152, 263, 292, 134, 544, 576, 350, 425, 488, 138, 225, 338, 391, 186, 144, 121, 380, 358, 136, 376, 226, 257, 364, 305, 403, 151, 149, 451, 494, 240, 231, 501, 423, 184, 21, 148, 131, 432, 167, 386, 351, 451, 560, 30, 157, 307, 37, 182, 457, 358, 44, 84, 413, 301, 266, 357, 165, 92, 28, 225, 503, 115, 387, 263, 302, 112, 446, 466, 45, 206, 543, 126, 246, 207, 528, 470, 319, 140, 319, 247, 457, 539, 198, 550, 285, 35, 336, 519, 17, 175, 149, 527, 357, 235, 349, 544, 382, 508, 154, 354, 165, 283, 474, 262, 225, 295, 273, 143]
    else:
        #25 uniformely distributed and 25 in 15 - 115
        random_numbers = [206, 91, 231, 321, 392, 325, 451, 347, 389, 104, 185, 497, 450, 473, 203, 404, 536, 301, 278, 131, 579, 323, 148, 567, 252, 111, 51, 34, 29, 109, 45, 19, 44, 73, 43, 95, 52, 96, 32, 48, 93, 34, 23, 79, 20, 15, 103, 21, 44, 100]
else: # CYCLE_IN_SECONDS == 3600
    if PATTERN==1:
        random_numbers = [356, 1419, 607, 3292, 547, 522, 261, 55, 3203, 561, 3094, 3033, 2370, 3324, 3563, 887, 311, 2881, 3218, 3560, 2149, 1264, 319, 2653, 1916, 1887, 2152, 994, 3535, 3520, 1916, 2972, 2080, 1470, 1534, 1653, 1096, 80, 196, 1421, 3485, 3204, 338, 2086, 2799, 2553, 2078, 3380, 780, 3145, 1934, 2023, 3036, 166, 539, 1326, 1717, 1457, 1440, 2508, 863, 3271, 767, 985, 857, 2716, 1490, 663, 3431, 1171, 3370, 1777, 1232, 3167, 653, 3097, 2858, 2538, 2082, 3134, 697, 1553, 3290, 2430, 271, 568, 536, 2185, 3415, 1172, 94, 1282, 1867, 1400, 3332, 3437, 1932, 1029, 1043, 218, 1328, 1663, 968, 2044, 2647, 1719, 2146, 1586, 193, 2055, 3119, 370, 76, 1204, 3121, 40, 1140, 1071, 1538, 2343, 3213, 3489, 1158, 2306, 592, 3438, 1176, 1479, 589, 2173, 2160, 1892, 335, 2709, 1263, 2568, 2149, 1450, 1412, 3284, 3467, 1929, 2899, 1788, 28, 2196, 3368, 3314, 2018, 1606, 963, 1489, 1580, 1175, 2860, 1308, 2052, 1099, 1921, 931, 2438, 407, 2229, 824, 477, 2964, 3536, 530, 1798, 1540, 1809, 2466, 2058, 1044, 3381, 3208, 218, 1280, 387, 2776, 2509, 2961, 2141, 3471, 1724, 1305, 2088, 1042, 3526, 273, 2974, 136, 1835, 1518, 307, 1638, 1391, 1644, 1599, 1030, 2476, 611, 1896, 1853, 777, 3043, 1531, 2074, 3045, 1469, 2128, 2082, 2044, 2986, 2399, 1478, 196, 155, 3261, 2694, 2795, 768, 2775, 138, 983, 1368, 2763, 3425, 1020, 968, 125, 3116, 2195, 1592, 926, 1940, 3017, 893, 332, 1522, 483, 2895, 339, 676, 1472, 95, 2524, 1275, 897, 2511, 940, 3405, 336, 879, 2669, 2959, 624, 2982, 2992, 2924, 229, 1302, 2167, 1479, 3421, 837, 27, 374, 545, 1164, 3428, 1612, 2001, 3252, 2085, 3335, 2087, 1719, 2220, 2561, 2657, 213, 1836, 1019, 2969, 3266, 1693, 626, 110, 565, 2795, 2068, 367, 2848, 2343, 1348, 2664, 71, 949, 130, 3142, 2244, 3388, 1059, 2581, 2197, 73, 1133, 2477, 20, 3228, 2451, 1316, 1997, 2846, 3469, 485, 2319, 2160, 543, 1024, 202, 279, 656, 1353, 1825, 1711, 3443, 2218, 573, 1412, 644, 2078, 1189, 2879, 2039, 257, 1034, 3348, 3469, 2002, 556, 2556, 637, 1881, 1183, 3567, 583, 802, 2224, 1879, 2472, 2279, 823, 702, 2499, 1967, 2059, 1806, 3291, 1058, 2227, 240, 3470, 567, 69, 2046, 3135, 1876, 1492, 2904, 3514, 3388, 3006, 237, 251, 294, 1765, 529, 1283, 2745, 1173, 1983, 598, 932, 3377, 2554, 703, 2053, 463, 3198, 477, 3398, 1782, 601, 3040, 2019, 3507, 1770, 1054, 3096, 2141, 1863, 3128, 1539, 1916, 2610, 922, 1984, 1339, 1677, 80, 3248, 1163, 2989, 1925, 3339, 3527, 2110, 985, 2912, 770, 946, 841, 2585, 3131, 166, 1774, 1697, 1688, 1776, 2103, 2001, 3234, 1713, 3543, 789, 969, 1048, 1201, 566, 257, 3483, 776, 2058, 499, 286, 1151, 976, 1752, 1506, 1181, 401, 576, 1682, 1264, 3008, 2678, 1617, 2218, 776, 213, 1138, 3395, 1733, 1555, 2317, 3399, 1160, 1331, 295, 2909, 2512, 1510, 2693, 2406, 3083, 1230, 2772, 3301, 1268, 445, 998, 2625, 2719, 3218, 747, 3485, 673, 585, 294, 1238, 1226, 2090, 1143, 2849, 2389, 991, 564, 3520, 2350, 2868, 1476, 3192, 2591, 1285, 2188, 1258, 1123, 1553, 925, 1353, 2794, 285, 527, 1426, 1536, 2034, 2222, 1973, 3213, 3532, 1612, 856, 1410, 2545, 1961, 2844, 2070, 3416, 2041, 1383, 1073, 429, 3437, 2428, 979, 1722, 194, 638, 3536, 1956, 274, 670, 2240, 142, 1015, 51, 3267, 68, 97, 168, 1871, 2857, 2580, 1314, 1799, 2340, 2175, 1736, 2126, 2035, 2648, 129, 2116, 1969, 112, 647, 3045, 2239, 3413, 1602, 2112, 213, 3045, 1953, 2349, 1604, 3313, 256, 2427, 669, 1768, 2611, 386, 853, 1393, 170, 2199, 2416, 3333, 1076, 943, 429, 3485, 1759, 638, 2837, 691, 1101, 1462, 3541, 2266, 1791, 2315, 105, 1299, 1869, 1931, 1106, 545, 2951, 1036, 1820, 371, 1645, 2382, 3452, 1425, 295, 3027, 98, 2242, 1105, 328, 2545, 2022, 2035, 3462, 46, 2275, 2522, 101, 145, 2023, 2280, 2410, 982, 1963, 1633, 2100, 1724, 2633, 57, 585, 187, 1519, 955, 3321, 2279, 1928, 1968, 1582, 2819, 604, 3131, 851, 646, 2995, 90, 3185, 489, 2502, 2812, 481, 1423, 2554, 2426, 2158, 971, 1226, 1140, 3245, 175, 1147, 2936, 1677, 625, 862, 270, 409, 2038, 2498, 1632, 644, 2624, 1766, 1528, 3260, 2666, 46, 656, 1836, 1132, 1135, 2605, 1335, 1179, 303, 2322, 2254, 2057, 1593, 1180, 1704, 1890, 3010, 1561, 1609, 3494, 250, 2761, 2162, 1887, 3158, 1420, 883, 2367, 1540, 1102, 3547, 1588, 905, 2308, 3418, 1843, 3538, 2162, 2606, 1985, 1125, 160, 1484, 898, 1764, 378, 3164, 3268, 1104, 2219, 2054, 835, 404, 199, 2011, 293, 2380, 2146, 2384, 351, 2954, 936, 814, 43, 2682, 238, 275, 480, 654, 575, 1143, 1701, 3247, 1536, 1966, 2201, 3170, 1222, 1682, 2711, 1868, 3001, 771, 1087, 462, 2882, 2347, 2708, 2781, 3222, 3081, 520, 1278, 2015, 966, 1523, 1610, 214, 511, 3573, 1928, 1508, 1944, 3240, 3255, 2932, 2830, 3119, 864, 1848, 3126, 3346, 873, 3425, 3463, 2240, 1728, 920, 2928, 145, 438, 3465, 602, 891, 1561, 2005, 180, 3221, 1826, 1243, 120, 1551, 2895, 3306, 1530, 1090, 946, 2632, 3193, 3482, 842, 3009, 3093, 2319, 1164, 1192, 3377, 2977, 3028, 1905, 136, 2451, 2411, 3385, 1162, 1543, 2423, 1694, 481, 905, 87, 3331, 3323, 1589, 2420, 2877, 2811, 3390, 3552, 1861, 825, 3559, 1035, 2849, 525, 1513, 77, 2627, 1509, 3541, 1741, 2969, 1321, 875, 2256, 2166, 1804, 3426, 3352, 1003, 3207, 1130, 1767, 1710, 1825, 494, 2333, 1487, 2930, 772, 119, 2218, 3462, 1890, 1382, 1204, 517, 1247, 2133, 1796, 3499, 1596, 1872, 997, 1094, 3331, 2692, 957, 990, 630, 689, 787, 2592, 570, 2117, 1270, 1056, 1746, 1425, 908, 1695, 2272, 2430, 1773, 27, 1642, 218, 1558, 865, 3461, 3502, 1957, 2644, 926, 3183, 2278, 547, 2691, 1963, 562, 596, 2362, 1238, 1242, 1632, 2109, 1226, 2627, 2409, 2510, 236, 1800, 849, 2681, 817, 25, 417, 437, 2887, 1342, 205, 3228, 1623, 3548, 533, 1242, 1394, 702, 2998, 1182, 1186, 552, 1493, 2008, 324, 441, 1508, 2489, 133, 843, 1627, 308, 3177, 1145, 2228, 323, 2527, 1854, 2541, 2734, 2443, 584, 2936, 1295, 2324, 2054, 270, 3555, 1121, 3053, 2128, 591, 1066, 2174, 88, 1365, 1099, 3339, 545, 2999, 411, 3116, 3428, 2638, 2318, 2632, 2185, 156, 2934, 326, 2123, 2117, 1804, 2569, 649, 3372, 254, 982, 2868, 3067, 996, 1253, 1504, 622, 652, 1679, 1756, 369, 3258, 181, 362, 809, 243, 229, 3419, 1221, 238, 1339, 1120, 1305, 2685, 2390, 1337, 2269, 2057, 2977, 2922, 3488, 150, 823, 3145, 2458, 1557, 174, 3563, 2251, 2458, 2838, 2131, 2323, 391, 183, 437, 2069, 728, 596, 1138, 585, 922, 3395, 2721, 2875, 2127, 3391, 1554, 2653, 2284, 1373, 2004, 655, 3148, 2070, 672, 3301, 2523, 1717, 326, 707, 1972, 2051, 573, 3217, 1340, 558, 3398, 2412, 1312, 2118, 1967, 1922, 933, 2095, 2461, 189, 1779, 1435, 1152, 2347, 2962, 915, 2947, 572, 474, 2795, 562, 1008, 1824, 303, 1260, 1134, 543, 3031, 2330, 3564, 2199, 2433, 1184, 1838, 1813, 2939, 210, 2010, 770, 596, 2505, 1089, 1165, 338, 2932, 1189, 2869, 1075, 3354, 1283, 2906, 680, 1013, 3341, 1701, 347, 215, 726, 2997, 3008, 2094, 98, 2700, 331, 2234, 2986, 2411, 3335, 2294, 3499, 603, 3499, 861, 2976, 3184, 1800, 763, 635, 2899, 2666, 2677, 2811, 2271, 3488, 1533, 3385, 2830, 2268, 2331, 1629, 2952, 2641, 3341, 335, 40, 3198, 1432, 1077, 1935, 2095, 2470, 3176, 2278, 2417, 1145, 652, 339, 933, 2557, 1206, 2491, 3502, 3490, 720, 1749, 169, 2354, 2835, 84, 2573, 3098, 3269, 1611, 2768, 2537, 1680, 3532, 2104, 817, 3206, 2803, 3302, 3306, 250, 1506, 201, 703, 1658, 871, 2881, 902, 3292, 3046, 974, 2871, 3511, 3346, 1242, 3043, 589, 170, 1211, 1601, 75, 1615, 1539, 2682, 2774, 1712, 1416, 1809, 2571, 571, 1423, 1680, 2104, 1823, 269, 2739, 267, 91, 2748, 1537, 3141, 3158, 1568, 1555, 33, 2257, 835, 1246, 1665, 1094, 2321, 1283, 2020, 2688, 2939, 875, 2909, 1632, 1417, 1947, 3112, 989, 2192, 1042, 995, 75, 432, 1749, 1963, 1609, 1875, 614, 2671, 2682, 2346, 259, 2053, 2836, 2480, 2481, 500, 3176, 1396, 2315, 2207, 2073, 3268, 1454, 1759, 1641, 3037, 1727, 58, 3087, 1346, 206, 1332, 2283, 2757, 974, 2968, 2956, 3565, 3342, 2251, 2710, 3037, 889, 2464, 934, 1068, 658, 3084, 1904, 3515, 791, 2988, 1553, 29, 2178, 906, 2601, 3339, 1591, 1357, 1793, 1110, 1096, 2094, 3480, 2828, 730, 382, 513, 143, 2355, 1300, 658, 1699, 616, 3013, 2800, 237, 1707, 2368, 2280, 994, 3353, 664, 2234, 16, 2838, 1958, 1535, 1416, 2593, 2770, 2902, 1477, 1154, 2181, 1098, 1828, 3036, 54, 3124, 1316, 2891, 2107, 257, 438, 2977, 2464, 1506, 734, 679, 83, 398, 180, 1027, 1954, 3221, 516, 767, 2670, 193, 3017, 3161, 467, 756, 1729, 1790, 91, 281, 1397, 1848, 1228, 2753, 2880, 1158, 457, 442, 2396, 1106, 883, 1457, 2032, 543, 1877, 3430, 464, 1764, 2684, 1007, 2518, 1682, 2017, 3396, 346, 169, 2281, 148, 1090, 3001, 2329, 3341, 3284, 2102, 1956, 3569, 1024, 3384, 2188, 640, 2832, 2165, 1178, 2741, 98, 1617, 3135, 3576, 978, 238, 167, 404, 2557, 684, 3371, 3091, 2593, 3467, 438, 2705, 1252, 2128, 2655, 1389, 2602, 734, 2932, 491, 1084, 2141, 3529, 3441, 3270, 1643, 1767, 679, 2229, 2185, 2361, 1548, 3272, 2554, 1698, 335, 394, 1505, 2404, 3290, 1779, 1157, 2157, 3045, 1041, 2864, 2844, 700, 2973, 944, 1184, 3242, 2882, 387, 1969, 3340, 2852, 1239, 2405, 1613, 909, 2305, 82, 3130, 1854, 1212, 3388, 3508, 1154, 3519, 3024, 1910, 3373, 878, 2677, 324, 2060, 2163, 1927, 967, 2597, 1873, 311, 1168, 1638, 1643, 2209, 1119, 1115, 726, 268, 237, 2549, 730, 489, 2457, 2140, 1131, 2068, 3007, 584, 871, 2403, 2442, 2743, 2333, 3437, 778, 1366, 2722, 1843, 783, 2505, 330, 1921, 336, 2313, 3581, 247, 2180, 2671, 1204, 1473, 1694, 343, 1278, 3006, 630, 765, 2446, 1726, 2362, 567, 562, 1636, 357, 1203, 1541, 95, 2623, 1278, 3128, 3475, 3278, 1589, 615, 2126, 231, 1303, 3033, 1076, 2959, 2908, 886, 264, 2509, 404, 1819, 1035, 229, 2444, 2855, 1338, 84, 1168, 170, 452, 2466, 3262, 2987, 3028, 1464, 3306, 2758, 3408, 760, 2389, 3175, 1253, 2726, 1196, 1271, 1551, 3267, 3443, 1839, 1425, 2093, 1575, 1937, 2478, 1935, 2345, 1485, 2485, 857, 1052, 1948, 1003, 983, 374, 1840, 3040, 1149, 898, 1908, 1758, 1762, 2535, 377, 1820, 320, 1450, 3364, 2343, 3227, 692, 1670, 1264, 2038, 1188, 2378, 2510, 2398, 1746, 2956, 2108, 1566, 129, 3172, 3131, 448, 2974, 38, 3296, 1668, 128, 1270, 2599, 3186, 3384, 1201, 3246, 2414, 538, 3034, 1126, 115, 223, 3019, 1764, 1566, 3210, 1742, 2321, 2048, 1939, 2632, 1015, 2597, 1987, 3172, 1718, 49, 3044, 2620, 2140, 1816, 3215, 2719, 818, 3173, 1268, 257, 1613, 825, 1852, 1839, 1028, 3130, 2138, 2809, 3553, 798, 1990, 2451, 3206, 3271, 488, 1096, 2122, 2409, 398, 1785, 3397, 3067, 3103, 2183, 2064, 2745, 315, 2291, 589, 2604, 2636, 139, 2759, 3075, 2690, 1690, 3188, 25, 1995, 2895, 1680, 2574, 613, 2176, 3493, 2214, 3511, 945, 1101, 2654, 1659, 681, 526, 663, 1578, 2177, 2797, 1219, 1191, 862, 2030, 1449, 36, 1239, 238, 879, 2267, 128, 397, 2657, 490, 2789, 243, 139, 237, 2165, 2081, 540, 2891, 2556, 3315, 461, 2782, 2427, 231, 2017, 1426, 2389, 165, 287, 3483, 2903, 3229, 1516, 2502, 756, 389, 111, 1225, 1817, 2201, 1977, 3539, 2334, 1406, 966, 1468, 2227, 1581, 3039, 3450, 1033, 2477, 409, 794, 1518, 49, 1379, 2138, 1956, 3446, 1218, 1744, 2308, 2966, 2979, 984, 1508, 33, 3382, 3225, 289, 2198, 1197, 203, 124, 1922, 393, 3372, 3068, 898, 558, 3298, 1793, 3138, 767, 3189, 2103, 2282, 100, 1633, 2545, 2015, 2576, 865, 312, 3497, 3292, 531, 3171, 247, 1229, 2906, 1116, 2957, 971, 747, 566, 2409, 1318, 112, 992, 37, 1158, 156, 2858, 1243, 1228, 480, 1849, 832, 3500, 2918, 538, 2551, 299, 217, 505, 142, 558, 1844, 222, 1688, 2260, 3181, 3455, 1575, 404, 2886, 1792, 1288, 724, 3568, 3331, 2633, 2804, 849, 117, 2730, 1025, 3155, 3563, 2028, 3239, 796, 3286, 114, 1795, 2319, 1182, 1589, 3421, 2354, 1946, 2651, 657, 91, 1415, 1837, 2960, 1842, 2274, 340, 101, 417, 2400, 2823, 754, 3031, 3414, 1917, 3076, 333, 2951, 1054, 2725, 595, 2085, 3044, 1135, 2059, 961, 2718, 2350, 566, 808, 913, 487, 3035, 175, 2564, 2657, 424, 454, 2122, 2223, 3119, 2110, 1400, 193, 3155, 2061, 3366, 1395, 286, 2163, 847, 119, 2095, 2549, 440, 2940, 1570, 239, 2893, 1728, 1229, 3036, 1346, 3433, 99, 667, 2148, 2783, 3499, 1143, 1733, 3467, 2455, 3422, 804, 2036, 3013, 3306, 1712, 1101, 3178, 1080, 308, 1320, 1796, 380, 40, 1622, 2206, 1739, 2433, 2549, 2765, 331, 1420, 1727, 1239, 2602, 1571, 174, 769, 501, 3072, 1698, 1007, 3377, 1515, 2416, 1084, 306, 385, 3218, 496, 2237, 2008, 2884, 3406, 2910, 2875, 1989, 729, 2202, 2166, 2648, 77, 1944, 2397, 677, 2225, 2799, 3425, 1843, 3447, 827, 3415, 2583, 3003, 806, 2756, 910, 294, 196, 3176, 3498, 202, 294, 3191, 1055, 1008, 2421, 1248, 3011, 3150, 1822, 2762, 2344, 105, 1003, 3244, 1783, 501, 2524, 1295, 3134, 2152, 3489, 3094, 2326, 2429, 2123, 1966, 2658, 1830, 1765, 2540, 1536, 706, 262, 2533, 1219, 2577, 2848, 918, 247, 1092, 2344, 2905, 735, 796, 3518, 3118, 141, 1897, 2917, 2746, 3549, 535, 1704, 2892, 212, 1932, 1181, 509, 2659, 1796, 1753, 1202, 640, 3065, 1557, 3170, 1522, 423, 3577, 2134, 1994, 2251, 608, 553, 1290, 1992, 1541, 458, 2437, 772, 668, 1885, 614, 2251, 1145, 1055, 799, 1345, 3416, 90, 2037, 43, 972, 1151, 3562, 1129, 2541, 1948, 1623, 2197, 2518, 365, 1397, 1738, 2734, 1389, 3167, 2240, 3101, 1053, 509, 1559, 1768, 1764, 813, 155, 2558, 192, 3574, 672, 1689, 1292, 319, 1344, 2893, 1405, 834, 115, 571, 1113, 1648, 89, 2177, 973, 639, 822, 2860, 3054, 180, 324, 64, 1179, 3401, 2229, 878, 1129, 348, 2576, 2265, 1492, 1444, 2502, 2929, 3110, 1111, 2622, 236, 147, 1914, 2499, 1804, 365, 1349, 1521, 3497, 2154, 830, 659, 2230, 2494, 445, 2942, 470, 2205, 2370, 1042, 3076, 3362, 1392, 3417, 2554, 16, 1907, 2384, 2469, 73, 2287, 280, 2890, 347, 173, 266, 3367, 2112, 1359, 1334, 1487, 2243, 691, 2286, 3518, 1170, 1506, 596, 1166, 1504, 1013, 1477, 2370, 1966, 647, 1567, 2639, 2492, 199, 810, 617, 1909, 2644, 1531, 1231, 2833, 517, 105, 2715, 1134, 266, 3211, 2156, 1569, 313, 194, 344, 2165, 2201, 3041, 2429, 2790, 2767, 410, 2187, 2446, 2896, 2266, 2635, 1950, 1310, 3175, 2807, 3376, 2279, 2930, 2361, 2871, 541, 2856, 1823, 1424, 3226, 1370, 340, 2561, 413, 2470, 481, 1860, 1263, 2315, 2589, 3319, 3384, 3255, 2147, 2022, 917, 946, 1120, 3578, 547, 986, 2251, 1414, 2636, 322, 225, 3123, 3330, 2387, 738, 218, 1357, 3000, 581, 2024, 1445, 85, 2812, 1040, 1321, 416, 3380, 1733, 573, 995, 3294, 1923, 2447, 2653, 43, 2672, 648, 2215, 3205, 429, 2762, 3163, 868, 2635, 579, 756, 93, 3001, 1853, 70, 2333, 1506, 1560, 1724, 404, 2193, 1738, 351, 3544, 2458, 765, 2779, 1977, 2190, 326, 2983, 1494, 3513, 2759, 86, 1754, 1569, 2895, 1257, 47, 443, 2706, 1230, 1783, 3181, 2435, 909, 603, 2707, 2366, 3263, 3248, 1745, 758, 3122, 1476, 2629, 3545, 1680, 2292, 2139, 99, 1295, 91, 1535, 2514, 3564, 762, 3012, 1363, 411, 3141, 154, 902, 1550, 290, 1234, 2414, 2002, 2445, 3264, 3240, 2160, 1460, 2498, 1963, 652, 3014, 853, 1192, 623, 846, 1080, 3080, 1917, 2364, 2565, 927, 2518, 3006, 508, 168, 3100, 1358, 2833, 2818, 73, 451, 2539, 2772, 1026, 994, 548, 2292, 3487, 2619, 1875, 346, 2424, 2822, 1101, 2409, 622, 81, 3496, 1939, 2619, 794, 1682, 1781, 690, 2571, 3375, 168, 3121, 2343, 405, 1134, 2898, 1278, 3024, 1635, 2155, 3233, 1458, 3527, 1590, 2444, 660, 2794, 1680, 937, 1192, 3123, 2012, 2745, 1259, 1523, 1698, 1060, 3269, 687, 1172, 2922, 2265, 1699, 1454, 270, 1498, 2914, 3056, 1655, 891, 1099, 3394, 493, 843, 2873, 2345, 1656, 272, 2128, 1663, 771, 1131, 3562, 3542, 3293, 1767, 2564, 628, 3225, 475, 433, 1747, 2372, 1229, 874, 1946, 716, 2722, 3537, 2171, 2489, 1433, 3244, 1590, 3227, 3091, 2528, 1399, 2166, 151, 2035, 234, 84, 847, 762, 2178, 2641, 2314, 2730, 2196, 3132, 1956, 2984, 731, 3216, 437, 2648, 2016, 1245, 2629, 2107, 1477, 3562, 2590, 1034, 2688, 2401, 2632, 1702, 1904, 3212, 2943, 2195, 1250, 519, 3270, 2956, 3573, 1739, 3398, 747, 2023, 2338, 1803, 2942, 1169, 2971, 3577, 830, 651, 3391, 1786, 1570, 624, 3419, 2099, 855, 1319, 2496, 140, 1906, 631, 2602, 702, 1029, 2603, 15, 241, 731, 2103, 459, 3300, 3501, 1827, 3200, 3211, 273, 94, 3522, 1149, 1508, 2499, 2449, 72, 1791, 2049, 2896, 836, 2123, 887, 1167, 3462, 972, 2485, 1593, 1407, 636, 1949, 3563, 3099, 1031, 2556, 3162, 525, 987, 1046, 432, 942, 2633, 534, 3258, 2501, 369, 356, 3419, 666, 1201, 2852, 479, 2532, 736, 2790, 1547, 2799, 703, 584, 2625, 2399, 1404, 3025, 701, 1714, 1106, 1948, 3438, 604, 1095, 2032, 1955, 1745, 80, 1192, 820, 1615, 1335, 571, 3419, 177, 2712, 662, 1595, 2117, 914, 875, 2255, 1157, 2568, 216, 2073, 921, 3371, 981, 1755, 3508, 409, 881, 78, 1666, 2602, 2226, 2261, 56, 1090, 221, 1706, 1671, 3542, 460, 1431, 3362, 2492, 3423, 505, 2120, 3241, 2825, 2944, 838, 3559, 2846, 3392, 921, 277, 924, 2485, 2833, 416, 3479, 707, 1520, 2173, 1747, 3169, 1460, 48, 3044, 2614, 2249, 900, 2781, 2576, 478, 405, 3164, 1663, 1096, 1217, 927, 1983, 2707, 1317, 241, 3243, 2353, 179, 3044, 2720, 3221, 2550, 2147, 1361, 3106, 2488, 1654, 1310, 2476, 1302, 1128, 1707, 588, 3254, 453, 3379, 867, 80, 2760, 2731, 1827, 534, 1969, 452, 3543, 2869, 2361, 1177, 1094, 1842, 39, 1818, 921, 332, 2361, 448, 655, 3577, 1305, 3190, 1002, 904, 3448, 2259, 1244, 47, 2771, 1937, 2328, 22, 2762, 819, 2864, 1316, 283, 799, 2864, 3571, 692, 1882, 1202, 3333, 1272, 1558, 2428, 85, 2504, 511, 446, 1649, 2367, 1538, 1097, 3472, 3332, 520, 1332, 2896, 3435, 718, 2169, 1572, 1122, 3206, 3083, 199, 447, 343, 1490, 2612, 1333, 3209, 2571, 2444, 2313, 1146, 105, 1071, 1519, 62, 335, 2208, 3339, 3051, 437, 2597, 1522, 436, 3359, 2179, 2799, 101, 601, 86, 2355, 3257, 2492, 1179, 1860, 1868, 3082, 1127, 1273, 1385, 1285, 770, 2329, 2494, 543, 2106, 3395, 3213, 2392, 422, 1468, 2922, 3268, 1495, 2953, 1039, 3476, 3205, 557, 1279, 3562, 3080, 1070, 1388, 990, 518, 865, 438, 3194, 1516, 2804, 2988, 2126, 2825, 154, 622, 2057, 1720, 945, 1716, 978, 378, 1807, 2892, 402, 2927, 3041, 204, 980, 833, 1015, 2125, 343, 2388, 1549, 1273, 488, 2318, 2639, 143, 1175, 1689, 2262, 2642, 2741, 869, 2376, 801, 3088, 1072, 1627, 1005, 691, 831, 1723, 3510, 1697, 413, 2865, 3394, 2832, 2072, 567, 2995, 1337, 948, 3572, 273, 3323, 2377, 1611, 3045, 2895, 1396, 198, 2743, 817, 2721, 2361, 3003, 3578, 3299, 1816, 3551, 823, 261, 1771, 3307, 1608, 1602, 2644, 249, 2823, 1631, 3300, 2748, 2118, 389, 2656, 2412, 344, 647, 1686, 449, 1046, 1989, 3371, 762, 2171, 2877, 196, 1234, 1540, 21, 1134, 315, 3331, 1968, 2196, 320, 3295, 3363, 679, 2622, 31, 1764, 2795, 598, 991, 1411, 283, 1253, 2512, 843, 2409, 827, 3054, 2566, 639, 1261, 550, 3092, 22, 2423, 601, 929, 2412, 3435, 2273, 2139, 2365, 918, 2567, 2149, 3515, 864, 1209, 1030, 667, 1497, 1447, 990, 819, 567, 739, 3538, 1094, 683, 1839, 771, 1871, 1390, 2836, 1007, 3383, 762, 2293, 2585, 1192, 1418, 1121, 1842, 328, 2666, 2350, 1560, 1188, 945, 3199, 647, 3120, 2811, 917, 596, 1497, 2518, 78, 1681, 413, 2887, 1691, 438, 3080, 2927, 2763, 2209, 3028, 513, 931, 338, 570, 3113, 3403, 2409, 1860, 3381, 321, 3188, 2645, 51, 3480, 632, 456, 799, 555, 1033, 338, 2820, 1840, 2055, 1766, 245, 2620, 1673, 1067, 2482, 3383, 743, 3482, 1117, 104, 2622, 1229, 3158, 3443, 3514, 461, 2610, 3483, 1291, 2592, 1362, 2327, 1655, 1243, 1423, 883, 731, 268, 1282, 2172, 560, 3398, 2381, 2715, 1898, 82, 1147, 1215, 552, 2866, 2806, 1314, 1297, 2404, 3032, 1882, 315, 1325, 663, 655, 1581, 2786, 1911, 1737, 1429, 495, 2773, 717, 755, 1716, 916, 892, 1580, 2043, 3022, 3194, 155, 1208, 2643, 2532, 2344, 52, 1672, 2202, 397, 3057, 261, 3371, 1062, 2341, 1609, 606, 2957, 199, 2074, 492, 266, 407, 2624, 2408, 17, 1710, 642, 1278, 1549, 718, 3442, 3370, 2477, 1439, 1848, 3244, 1156, 884, 3090, 2350, 947, 632, 1694, 2264, 2040, 589, 2843, 1907, 2612, 242, 80, 450, 3536, 2605, 2727, 180, 2566, 1868, 3385, 2174, 2586, 315, 1342, 1863, 2263, 547, 721, 3098, 35, 1394, 2043, 354, 2674, 3094, 494, 2646, 493, 1890, 897, 658, 2490, 1583, 2453, 2758, 603, 558, 2737, 1402, 1665, 3354, 1754, 3473, 1264, 2299, 2689, 3064, 1735, 314, 1628, 1755, 984, 1259, 1834, 1175, 575, 2818, 601, 55, 2292, 1311, 734, 3197, 2221, 3303, 1804, 1086, 1485, 128, 2433, 1368, 167, 145, 442, 1494, 2967, 597, 1292, 3258, 3390, 2013, 1056, 818, 1646, 1994, 3298, 1452, 3473, 2695, 71, 3460, 79, 153, 655, 2485, 3064, 2557, 3107, 2653, 2596, 1359, 3120, 2717, 950, 1184, 58, 1438, 1487, 1097, 1137, 1679, 757, 2403, 2159, 495, 3460, 49, 951, 183, 2608, 2213, 1446, 611, 2561, 2273, 2575, 2785, 1956, 3127, 3092, 1743, 1899, 1039, 876, 2670, 3451, 2539, 2702, 2613, 1101, 1533, 2381, 3446, 3019, 2785, 1582, 3581, 1453, 2725, 3372, 2125, 3195, 3254, 3497, 946, 1810, 2875, 2602, 1958, 2054, 2108, 2604, 2616, 3116, 1969, 1716, 1650, 2202, 3194, 3355, 664, 1731, 3072, 3564, 2478, 2619, 929, 3538, 3509, 2350, 1787, 3009, 3407, 697, 874, 836, 221, 2082, 1799, 1470, 3304, 1945, 654, 2281, 1599, 558, 2919, 3493, 1148, 814, 325, 1333, 971, 1858, 1732, 3465, 2654, 716, 2013, 1334, 1034, 3350, 3100, 2879, 1372, 2222, 2790, 2346, 513, 2479, 3111, 1002, 2274, 1093, 1647, 3504, 49, 1604, 2365, 243, 3380, 2493, 1043, 2917, 829, 2274, 3029, 3352, 2048, 255, 1494, 1601, 684, 267, 749, 2722, 1296, 3012, 1504, 43, 3361, 3360, 3343, 828, 2880, 3490, 1387, 3469, 2804, 2977, 3180, 2878, 1893, 159, 770, 1608, 362, 2228, 1545, 2355, 644, 1050, 2616, 2501, 1119, 2402, 584, 3309, 3213, 457, 17, 3180, 2022, 2482, 2691, 3029, 3219, 1937, 487, 2036, 1476, 3233, 448, 146, 2986, 2288, 3004, 234, 3129, 3065, 3061, 3199, 1099, 1087, 659, 3392, 1991, 1635, 2640, 2096, 2093, 2997, 92, 1748, 554, 2118, 2955, 1969, 205, 1247, 240, 2076, 505, 1172, 2538, 2646, 1590, 315, 2798, 1218, 715, 2906, 1653, 1522, 368, 3065, 535, 905, 2633, 3247, 2151, 2259, 1307, 1244, 3010, 2558, 1348, 2884, 2957, 1891, 1674, 2707, 1029, 302, 3334, 2912, 2968, 72, 940, 1942, 2599, 1308, 3043, 125, 3015, 1837, 1375, 2200, 1469, 291, 2682, 1782, 3380, 190, 486, 353, 3519, 2758, 1146, 633, 2029, 2645, 872, 2289, 182, 1765, 1438, 3269, 435, 2109, 1379, 3355, 2208, 511, 569, 1720, 3520, 2390, 3365, 274, 1115, 1007, 927, 1179, 1800, 2474, 2078, 2548, 1059, 1964, 1367, 2887, 3462, 424, 2258, 2726, 1799, 738, 1686, 1794, 2794, 2323, 2590, 2649, 2506, 758, 206, 3348, 444, 2981, 1698, 1316, 1127, 619, 1232, 2436, 1826, 3182, 44, 1020, 1731, 1500, 2225, 2552, 3413, 457, 1029, 2131, 2016, 2039, 1320, 1165, 592, 1998, 1185, 1936, 2472, 1766, 1324, 907, 1589, 1120, 530, 1604, 93, 1674, 657, 2361, 94, 3036, 949, 480, 2604, 462, 2759, 1085, 1150, 3487, 2842, 331, 783, 15, 3314, 1969, 1188, 3241, 3370, 2368, 58, 2107, 2412, 1317, 3290, 1749, 3487, 1587, 1118, 2548, 2222, 1975, 873, 1030, 1746, 523, 1189, 317, 3033, 2485, 2937, 3331, 544, 2921, 339, 1534, 1039, 1489, 2698, 2331, 2583, 1974, 2615, 680, 1553, 36, 892, 3433, 1626, 471, 2120, 220, 2750, 1281, 3454, 500, 1322, 425, 663, 3218, 2943, 1917, 3372, 2225, 3287, 706, 2951, 1114, 755, 1144, 2622, 1708, 3355, 1327, 579, 2967, 1958, 806, 205, 2796, 1320, 112, 2698, 740, 1867, 92, 1898, 2612, 1679, 2264, 3213, 2536, 3295, 2440, 3410, 1092, 2758, 308, 3214, 647, 2015, 225, 15, 3150, 3570, 2630, 2443, 1474, 1155, 988, 2302, 3122, 1576, 767, 3526, 2630, 1010, 2253, 676, 968, 3045, 256, 2900, 3351, 3411, 479, 776, 2572, 960, 571, 828, 426, 140, 223, 903, 2293, 3062, 1445, 2397, 2082, 1549, 1160, 3369, 481, 1215, 2272, 3476, 875, 3478, 1100, 2067, 544, 489, 2099, 1788, 710, 1296, 1902, 3059]
    else:
        # 150 uniformely distributed and 150 in 15 - 115
        random_numbers = [3018, 523, 911, 3562, 2630, 778, 1166, 2316, 1083, 587, 352, 2863, 706, 3302, 1433, 881, 2645, 20, 1572, 1238, 1388, 107, 1146, 844, 3125, 973, 642, 2152, 1661, 986, 2944, 2388, 740, 1651, 2821, 1539, 1556, 1752, 1230, 3024, 1898, 3228, 1421, 2413, 2383, 2251, 1397, 417, 2271, 2348, 3034, 1528, 2258, 3269, 2926, 2105, 2056, 685, 2040, 2762, 2599, 1199, 2788, 927, 15, 1278, 2056, 151, 2279, 478, 945, 1776, 1236, 2012, 2526, 356, 2766, 208, 2778, 2283, 2660, 2855, 2256, 3422, 1829, 2599, 1983, 2314, 3008, 282, 2525, 3409, 2635, 1206, 1678, 1221, 390, 763, 2623, 3479, 941, 3180, 1819, 887, 302, 3507, 2510, 1192, 2089, 3351, 2634, 373, 264, 2884, 2033, 1692, 1936, 1270, 1835, 1576, 1787, 1452, 1123, 1216, 1071, 2534, 2110, 506, 2501, 2466, 2721, 175, 3411, 181, 275, 847, 422, 2522, 2662, 2177, 1311, 102, 1649, 3062, 3050, 1850, 1293, 3504, 2145, 1932, 113, 15, 57, 22, 61, 18, 57, 31, 98, 70, 96, 18, 101, 49, 61, 87, 84, 22, 48, 19, 67, 73, 76, 39, 94, 90, 96, 30, 16, 20, 42, 81, 99, 78, 59, 51, 16, 58, 20, 32, 31, 24, 92, 76, 19, 73, 51, 27, 36, 113, 43, 114, 98, 114, 23, 91, 67, 53, 71, 16, 107, 63, 18, 85, 109, 113, 68, 48, 83, 53, 65, 61, 100, 41, 55, 93, 51, 47, 30, 62, 42, 79, 110, 20, 22, 76, 54, 84, 86, 109, 25, 80, 108, 59, 46, 21, 65, 15, 89, 22, 87, 71, 21, 26, 113, 82, 95, 97, 85, 95, 45, 104, 109, 81, 112, 113, 53, 45, 98, 44, 99, 113, 72, 107, 109, 108, 64, 105, 70, 103, 17, 93, 49, 106, 32, 38, 97, 41, 54, 46, 54, 53, 73, 63, 28, 73, 112, 50, 85, 18]

CONFERENCES = 0
if CYCLE_IN_SECONDS==600:
    CONFERENCES=50
else:
    CONFERENCES = 300




INICI_CONF=[] # Fixe per tota la simulacio, de llargaria numero de videoconf. en un cycle (i amb valors de 0 a CYCLE_IN_SECONDS)
for index_i in range(CONFERENCES): # anem a omplir de moltes videoconf.
    index_pos_conf = random_numbers.pop()
    INICI_CONF.append(index_pos_conf)




class User:
    def __init__(self,type_user,duration,id):
        self.type = type_user # 1 o 2, els 1's fan augmentar la cpu un 1% i els 2 un 5%
        self.duration = duration # same for all participants of same conference, in seconds
        self.id = id

    def advance_round(self):
        self.duration= self.duration - 1

class JVB:
    def __init__(self):
        self.users_connected = []
        self.cpu_load = None
        self.up = False

    def is_up(self):
        return self.up

    def start(self):
        self.cpu_load = 0
        self.up = True

    def close(self):
        self.users_connected = []
        self.cpu_load = None
        self.up = False

    def add_user(self,user):

        if self.up:
            self.users_connected.append(user)
            if user.type == 1:
                self.cpu_load = self.cpu_load + CPU_TYPE_1
            else:
                self.cpu_load = self.cpu_load + CPU_TYPE_2
            return 1
        return 0

    def advance_round(self):
        for user in reversed(self.users_connected):
            user.advance_round()
            if user.duration == 0:
                self.users_connected.remove(user)
                if user.type==1:
                    self.cpu_load = self.cpu_load - CPU_TYPE_1
                else:
                    self.cpu_load = self.cpu_load - CPU_TYPE_2

class Jitsi:
    def __init__(self):

        self.video_bridges = []
        for i in range(MAX_JBS):
            self.video_bridges.append(JVB())

        self.video_bridges[0].start() # always 1 up...
        self.video_bridges_up = 1

        self.flag_up = 0
        self.flag_down = 0
        self.counter_flag = 0

        #self.highest_mean_cpu = 100

    def start_jvb_flag(self):

        if self.video_bridges_up < MAX_JBS:
            self.flag_up= 1
            self.counter_flag = 15
            return 1
        return 0

    def stop_jvb_flag(self):

        if self.video_bridges_up > 1:
            self.flag_down = 1
            self.counter_flag = 15
            return 1
        return 0

    def start_jvb(self):

        self.flag_up = 0
        self.get_some_jvb_down().start()
        self.video_bridges_up += 1

    def stop_jvb(self):

        self.flag_down = 0
        jvb_selected = self.get_least_loaded_jvb()
        users_to_reallocate = jvb_selected.users_connected
        jvb_selected.close()
        self.video_bridges_up -= 1

        for user in users_to_reallocate:
            jvb_selected = self.get_least_loaded_jvb()
            jvb_selected.add_user(user)

    def add_user_jitsi(self,user):
        jvb_selected = self.get_least_loaded_jvb()
        jvb_selected.add_user(user)

    def advance_round(self):

        for jvb in self.video_bridges:
            if jvb.is_up():
                jvb.advance_round()

        if self.flag_up == 1 and self.flag_down == 1:
            print("Whaaaat")

        if self.flag_up==1 or self.flag_down == 1:
            self.counter_flag = self.counter_flag -1
            if self.counter_flag ==0:
                if self.flag_up == 1:
                    self.start_jvb()
                else:
                    self.stop_jvb()

    def get_users_connected(self):

        num_users=0
        for jvb in self.video_bridges:
            num_users= num_users + len(jvb.users_connected)

        return num_users

    def get_state(self):

        state = [self.video_bridges_up, ROUND_COUNTER, self.get_mean_cpu()]

        return state

    def get_mean_cpu(self):

        total_cpu = 0

        for jvb in self.video_bridges:
            if jvb.is_up():
                total_cpu = total_cpu + jvb.cpu_load

        #if (total_cpu>150):
        #    print(total_cpu/self.video_bridges_up)

        return total_cpu/self.video_bridges_up

    def get_least_loaded_jvb(self):

        jvb_selected = None
        cpu_min = 10000

        for jvb in self.video_bridges:

            if jvb.is_up():

                if jvb.cpu_load <= cpu_min:
                    cpu_min = jvb.cpu_load
                    jvb_selected = jvb

        return jvb_selected

    def get_most_loaded_jvb(self):

        jvb_selected = None
        cpu_max = 0

        for jvb in self.video_bridges:

            if jvb.is_up():

                if jvb.cpu_load >= cpu_max:
                    cpu_max = jvb.cpu_load
                    jvb_selected = jvb

        return jvb_selected

    def get_some_jvb_down(self):

        jvb_down = None

        for jvb in self.video_bridges:
            if not jvb.is_up():
                jvb_down = jvb
                break

        return jvb_down





class Autoscaler:

    def __init__(self,jitsi,threshold_up, threshold_down):
        self.jitsi = jitsi
        self.threshold_up = threshold_up
        self.threshold_down = threshold_down

    def perform_action(self,jitsi_state):

        if jitsi_state[2] <= self.threshold_down:
            action_performed = self.jitsi.stop_jvb_flag()
            if action_performed==1:
                advance_rounds(self.jitsi, 20)
            return -1
        elif jitsi_state[2] >= self.threshold_up:
            action_performed = self.jitsi.start_jvb_flag()
            if action_performed==1:
                advance_rounds(self.jitsi, 20)
            return 1
        return 0

class AutoscalerRL:

    def __init__(self,jitsi,policy):
        self.jitsi = jitsi
        self.policy = policy

    def perform_action(self,jitsi_state):
        # It returns the action as well
        coor = get_coordinates_state(jitsi_state)

        if self.policy[coor[0]][coor[1]][coor[2]] == 1:
            action_performed = self.jitsi.start_jvb_flag()
            if action_performed == 1:
                advance_rounds(self.jitsi, 20)
                #pass
            return 1
        elif self.policy[coor[0]][coor[1]][coor[2]] == -1:
            action_performed = self.jitsi.stop_jvb_flag()
            if action_performed == 1:
                advance_rounds(self.jitsi, 20)
                #pass
            return -1
        return 0

    def set_policy(self,policy):
        self.policy= policy

class NoAutoscaler:
    def __init__(self,jitsi):
        self.jitsi = jitsi

    def perform_action(self,jitsi_state):
        return 0

class YesAutoscaler:
    def __init__(self,jitsi):
        self.jitsi = jitsi

    def perform_action(self,jitsi_state):
        action_performed = self.jitsi.start_jvb_flag()
        if action_performed == 1:
            advance_rounds(self.jitsi, 20)
        return 1




def new_users(jitsi):
    global ID_USER

    list_of_users_to_connect = horari[ROUND_COUNTER]
    if list_of_users_to_connect is not None:
        for con_user in list_of_users_to_connect:
            jitsi.add_user_jitsi(User(con_user[0], con_user[1], ID_USER))
            ID_USER = ID_USER + 1

def update_price(jitsi):
    global TOTAL_PRICE

    TOTAL_PRICE = TOTAL_PRICE + PRICE_JB_S * jitsi.video_bridges_up

    mean_cpu = jitsi.get_mean_cpu()

    if mean_cpu >= CPU_LOAD_SLA:
        TOTAL_PRICE = TOTAL_PRICE + PRICE_SLA_S * (1 + (mean_cpu - CPU_LOAD_SLA) / CPU_LOAD_SLA)

def advance_rounds(jitsi,rounds):
    global ROUND_COUNTER
    global TOTAL_ROUND_COUNTER

    for i in range(rounds):

        # Start of the round:
        new_users(jitsi)
        update_price(jitsi)

        ##
        ## ROUND HAPPENING...
        ##

        # End of the round:
        jitsi.advance_round()

        TOTAL_ROUND_COUNTER = TOTAL_ROUND_COUNTER + 1
        ROUND_COUNTER = ROUND_COUNTER + 1
        if ROUND_COUNTER == CYCLE_IN_SECONDS:
            ROUND_COUNTER=0
            populate_timetable()

def test_autoscaler(type_autoscaler,policy):

    global ROUND_COUNTER, TOTAL_ROUND_COUNTER, TOTAL_PRICE, ID_USER, TOTAL_EXP

    ROUND_COUNTER = 0  # in seconds
    TOTAL_ROUND_COUNTER = 0  # in seconds
    TOTAL_PRICE = 0  # in euros
    ID_USER = 0

    populate_timetable()

    jitsi = Jitsi()
    autoscaler = None

    if type_autoscaler==1:

        threshold_up= 50
        threshold_down= 10
        autoscaler = Autoscaler(jitsi,threshold_up,threshold_down)
        print(str(threshold_up) + "-" + str(threshold_down))
    elif type_autoscaler==2:

        threshold_up = 50
        threshold_down = 20
        autoscaler = Autoscaler(jitsi, threshold_up, threshold_down)
        print(str(threshold_up) + "-" + str(threshold_down))
    elif type_autoscaler==3:

        threshold_up = 50
        threshold_down = 30
        autoscaler = Autoscaler(jitsi, threshold_up, threshold_down)
        print(str(threshold_up) + "-" + str(threshold_down))
    elif type_autoscaler==4:

        threshold_up = 60
        threshold_down = 10
        autoscaler = Autoscaler(jitsi, threshold_up, threshold_down)
        print(str(threshold_up) + "-" + str(threshold_down))
    elif type_autoscaler==5:

        threshold_up = 60
        threshold_down = 20
        autoscaler = Autoscaler(jitsi, threshold_up, threshold_down)
        print(str(threshold_up) + "-" + str(threshold_down))
    elif type_autoscaler==6:

        threshold_up = 60
        threshold_down = 30
        autoscaler = Autoscaler(jitsi, threshold_up, threshold_down)
        print(str(threshold_up) + "-" + str(threshold_down))
    elif type_autoscaler==7:

        threshold_up = 40
        threshold_down = 10
        autoscaler = Autoscaler(jitsi, threshold_up, threshold_down)
        print(str(threshold_up) + "-" + str(threshold_down))
    elif type_autoscaler==8:
        autoscaler = NoAutoscaler(jitsi)
    elif type_autoscaler==9:
        autoscaler = AutoscalerRL(jitsi,policy)
    elif type_autoscaler==10:
        autoscaler = YesAutoscaler(jitsi)
    elif type_autoscaler==11:

        threshold_up = 40
        threshold_down = 20
        autoscaler = Autoscaler(jitsi, threshold_up, threshold_down)
        print(str(threshold_up) + "-" + str(threshold_down))
    elif type_autoscaler==12:

        threshold_up = 40
        threshold_down = 30
        autoscaler = Autoscaler(jitsi, threshold_up, threshold_down)
        print(str(threshold_up) + "-" + str(threshold_down))
    elif type_autoscaler==13:

        threshold_up = 40
        threshold_down = 30
        autoscaler = Autoscaler(jitsi, threshold_up, threshold_down)
        print(str(threshold_up) + "-" + str(threshold_down))



    while TOTAL_ROUND_COUNTER < 604800:

        state = jitsi.get_state()
        autoscaler.perform_action(state)
        advance_rounds(jitsi, PHOTO_INTERVAL)


    print()
    print(str(round(TOTAL_PRICE, 2)) + " Euros")
    if type_autoscaler==9:
        TOTAL_EXP = TOTAL_EXP + round(TOTAL_PRICE, 2)
    print()




def add_conference(temps_x,pos_x,tipus_x):
    # Conf 1.
    for i in range(tipus_x[0]):

        plus = round(np.random.normal(0, 3, 1)[0])

        if plus > 10 or plus < -10:
            plus = 0

        pos = int(pos_x + plus)
        if horari[pos] == None:
            horari[pos] = [[1, temps_x]]
        else:
            horari[pos].append([1, temps_x])

    for i in range(tipus_x[1]):

        plus = round(np.random.normal(0, 3, 1)[0])

        if plus > 10 or plus < -10:
            plus = 0

        pos = int(pos_x + plus)
        if horari[pos] == None:
            horari[pos] = [[2, temps_x]]
        else:
            horari[pos].append([2, temps_x])

def populate_timetable():
    global horari

    horari = [None] * CYCLE_IN_SECONDS
    # MAXIM QUE PUGUI CARREGAR 150! 15*6 = 90 users
    # Enregistrar aquestes dades de Jitsi realment...
    for pos_conf in INICI_CONF:
        # temps_x = randint(60, 120)
        temps_x = round(np.random.normal(DURACIO_VID, 10, 1)[0])
        if temps_x < DURACIO_VID_MIN or temps_x > DURACIO_VID_MAX:
            temps_x = DURACIO_VID
        pos_x = pos_conf
        tipus_x = [5, 1] # 5 de tipus 1 i 1 de tipus 2 = 6

        add_conference(temps_x, pos_x, tipus_x)




def get_closest(number,to):

    if number is None:
        return None

    number_decimal = float(number) / to
    number_rounded = round(number_decimal)
    number_final = int(number_rounded * to)

    return number_final

    """
    while 1:
        if number % 10 == 0:
            break
        else:
            number = number-1

    return number
    """

def compute_reward_state(state):

    cost = (state[0]*PRICE_JB_S) * PHOTO_INTERVAL

    if state[2]>=CPU_LOAD_SLA:
        cost = cost + (1 + (state[2]-CPU_LOAD_SLA)/CPU_LOAD_SLA)*PRICE_SLA_S * PHOTO_INTERVAL

    return - cost

def get_coordinates_state(jitsi_state):

    coordernada_x = jitsi_state[0] - 1
    coordernada_y = int(get_closest(jitsi_state[1],QUANTIZATION_TIME) / QUANTIZATION_TIME)
    coordernada_z = int(get_closest(jitsi_state[2],QUANTIZATION_CPU) / QUANTIZATION_CPU)

    return [coordernada_x,coordernada_y,coordernada_z]




def get_num_action_2(action):
    if(action==-1):
        return 0
    if(action==0):
        return 1
    if(action==1):
        return 2

def get_action_2(action_num):
    if(action_num==0):
        return -1
    if(action_num==1):
        return 0
    if(action_num==2):
        return 1

def argmax_a_2(Q,state):
    coor = get_coordinates_state(state)

    best_action = get_action_2(0)
    best_q = Q[0][coor[0]][coor[1]][coor[2]]

    if Q[1][coor[0]][coor[1]][coor[2]] > best_q:
        best_action = get_action_2(1)
        best_q = Q[1][coor[0]][coor[1]][coor[2]]

    if Q[2][coor[0]][coor[1]][coor[2]] > best_q:
        best_action = get_action_2(2)
        best_q = Q[2][coor[0]][coor[1]][coor[2]]

    return best_action

def max_a_2(Q,state):
    coor = get_coordinates_state(state)

    best_q = Q[0][coor[0]][coor[1]][coor[2]]

    if Q[1][coor[0]][coor[1]][coor[2]] > best_q:
        best_q = Q[1][coor[0]][coor[1]][coor[2]]

    if Q[2][coor[0]][coor[1]][coor[2]] > best_q:
        best_q = Q[2][coor[0]][coor[1]][coor[2]]

    return best_q





def main2():

    global ROUND_COUNTER, TOTAL_ROUND_COUNTER, TOTAL_PRICE, ID_USER, TOTAL_EXP

    print("What do you want to do?:")
    option_selected = "1"

    for num_experiments in range(NUM_EXP):

        print("##########################################")
        print("##########################################")
        print("EXPERIMENT NUMBER " + str(num_experiments))
        print("##########################################")
        print("##########################################")

        #"""
        if option_selected == "1":

            test_autoscaler(1, None)

        if option_selected == "1":

            test_autoscaler(2, None)

        if option_selected == "1":

            test_autoscaler(3, None)

        if option_selected == "1":

            test_autoscaler(4, None)

        if option_selected == "1":

            test_autoscaler(5, None)

        if option_selected == "1":

            test_autoscaler(6, None)

        if option_selected == "1":

            test_autoscaler(7, None)

        if option_selected == "1":

            test_autoscaler(8, None)
        #"""
        if option_selected == "1":

            ROUND_COUNTER = 0  # in seconds
            TOTAL_ROUND_COUNTER = 0  # in seconds
            TOTAL_PRICE = 0  # in euros
            ID_USER = 0

            populate_timetable()

            #"""
            volum_dimensio_number_jitsi = MAX_JBS
            volum_dimensio_temps = int(CYCLE_IN_SECONDS / QUANTIZATION_TIME + 1)
            volum_dimensio_cpu = int(4000 / QUANTIZATION_CPU + 1) # 400 or bigger...

            policy_actual = np.zeros((volum_dimensio_number_jitsi, volum_dimensio_temps, volum_dimensio_cpu))
            #"""

            jitsi = Jitsi()
            autoscaler = AutoscalerRL(jitsi,policy_actual)

            # Un estat seria algo com [1,15,43,None]
            # V_policy_actual(s) = un valor
            # V_policy_actual = dimensio de policy? Si
            # Q_policy_actual = mes gran que la dimensio de la policy

            #"""
            current_state = jitsi.get_state()
            Q = np.zeros((3, volum_dimensio_number_jitsi, volum_dimensio_temps, volum_dimensio_cpu))

            EPSILON = 1.00
            number_of_iterations = int(sys.argv[2])
            DECAYING_EPSILON = 1.0/number_of_iterations

            print("Q.TIME: " + str(QUANTIZATION_TIME))
            print("Q.CPU: " + str(QUANTIZATION_CPU))
            print("ALPHA: " + str(ALPHA))
            print("ITERATIONS: " + str(number_of_iterations))
            print("CYCLE: "+ str(CYCLE_IN_SECONDS))
            print("PATTERN: " + str(PATTERN))
            #"""

            for t in range(number_of_iterations):

                print_wait_info(t, number_of_iterations)

                # (s,a,r,s')
                action = autoscaler.perform_action(current_state)
                reward = compute_reward_state(current_state)  # afegir cost si obres o tanques? R(s,a,s')
                advance_rounds(jitsi, PHOTO_INTERVAL)
                next_state = jitsi.get_state()

                coor = get_coordinates_state(current_state)
                Q_t_minus_1 = Q[get_num_action_2(action)][coor[0]][coor[1]][coor[2]]

                #if t%(number_of_iterations/10)== 0 and t!=0:
                #    ALPHA= ALPHA/2

                Q[get_num_action_2(action)][coor[0]][coor[1]][coor[2]] = Q_t_minus_1 + ALPHA * (reward + GAMMA * max_a_2(Q, next_state) - Q_t_minus_1)

                policy_actual[coor[0]][coor[1]][coor[2]] = argmax_a_2(Q, current_state)
                random_int = randint(0, 99)
                if random_int < int(EPSILON * 100):
                    policy_actual[coor[0]][coor[1]][coor[2]] = get_action_2(randint(0, 2))

                autoscaler.set_policy(policy_actual)

                EPSILON = EPSILON - DECAYING_EPSILON

                current_state = next_state


            test_autoscaler(9,policy_actual)

        if option_selected == "1":

            test_autoscaler(10, None)

        if option_selected == "1":

            test_autoscaler(11, None)

        if option_selected == "1":

            test_autoscaler(12, None)

        if option_selected == "1":

            test_autoscaler(13, None)


    print(TOTAL_EXP / NUM_EXP)




















class ChanceNode:
    def __init__(self, x,y,action):
        self.action = action
        self.x = x
        self.y = y
        self.trans_probabilities = np.zeros((NUM_STATES,), dtype=float)

        if action=='N':

            self.set_trans_probability(x, y + 1, 0.7)
            self.set_trans_probability(x + 1, y, 0.15)
            self.set_trans_probability(x - 1, y, 0.15)
        elif action=='S':

            self.set_trans_probability(x, y - 1, 0.7)
            self.set_trans_probability(x + 1, y, 0.15)
            self.set_trans_probability(x - 1, y, 0.15)
        elif action=='W':

            self.set_trans_probability(x - 1, y, 0.7)
            self.set_trans_probability(x, y + 1, 0.15)
            self.set_trans_probability(x, y - 1, 0.15)
        elif action=='E':

            self.set_trans_probability(x + 1, y, 0.7)
            self.set_trans_probability(x, y + 1, 0.15)
            self.set_trans_probability(x, y - 1, 0.15)
        elif action=='·':
            self.set_trans_probability(x ,y, 0.8)
            self.set_trans_probability(x, y + 1, 0.05)
            self.set_trans_probability(x, y - 1, 0.05)
            self.set_trans_probability(x + 1, y, 0.05)
            self.set_trans_probability(x - 1, y, 0.05)

    def set_trans_probability(self,x,y,prob):

        if(0 <= x and x <= X_SIZE-1 and 0 <= y and y <= Y_SIZE-1):
            self.trans_probabilities[x + y*Y_SIZE] = prob
        else:
            self.trans_probabilities[self.x + self.y*Y_SIZE] += prob

    def possible_next_sates(self,states):

        possible_sates = []

        for x in range(X_SIZE):
            for y in range(Y_SIZE):
                prob_to_that_state = self.trans_probabilities[x + y * Y_SIZE]

                if prob_to_that_state != 0:
                    possible_sates.append([find_state(x, y, states), prob_to_that_state])
                    # print (str(x) + " - " +str(y) + " with prob: "+ str(prob_to_that_state))

        return possible_sates

    def next_state(self, states):

        possible_sates = self.possible_next_sates(states)

        # Com a minim hi haura dos possible_state's no?
        random_int = randint(0, 99)
        definitive_next_state = None

        acumulative=0

        for s in possible_sates:

            acumulative = acumulative + s[1]

            if random_int < acumulative * 100:
                definitive_next_state = s[0]
                break


        return definitive_next_state

class State:
    def __init__(self, x, y, end,cost):
        self.x = x
        self.y = y
        self.end = end
        self.chance_nodes = None
        self.cost = cost

        if end==False:
            self.chance_nodes = [ChanceNode(x,y,'N'),ChanceNode(x,y,'S'),ChanceNode(x,y,'W'),ChanceNode(x,y,'E'),ChanceNode(x,y,'·')]

    def next_state(self, action, states):

        if self.end==True:
            return self # o None?
        if action=='N':
            return self.chance_nodes[0].next_state(states)
        if action=='S':
            return self.chance_nodes[1].next_state(states)
        if action=='W':
            return self.chance_nodes[2].next_state(states)
        if action=='E':
            return self.chance_nodes[3].next_state(states)
        if action=='·':
            return self.chance_nodes[4].next_state(states)

    def get_chance_node(self, action):
        if self.end ==True:
            return None
        if action == 'N':
            return self.chance_nodes[0]
        if action == 'S':
            return self.chance_nodes[1]
        if action == 'W':
            return self.chance_nodes[2]
        if action == 'E':
            return self.chance_nodes[3]
        if action == '·':
            return self.chance_nodes[4]


def find_state(x,y,states):

    result = None

    for s in states:
        if s.x==x and s.y==y:
            result = s

    return result

def compute_cost(x,y):
    return (pow(x - OPTIMAL_X, 2) + pow(y - OPTIMAL_Y, 2))

def compute_reward(x,y,action):

    desired_x =x
    desired_y =y

    if action=='N':
        desired_y = desired_y + 1
    elif action=='S':
        desired_y = desired_y - 1
    elif action == 'W':
        desired_x = desired_x - 1
    elif action == 'E':
        desired_x = desired_x + 1
    elif action == '·':
        pass

    reward = 0.0

    if (0 <= desired_x and desired_x <= X_SIZE - 1 and 0 <= desired_y and desired_y <= Y_SIZE - 1):
        if action!='·':
            reward =  (compute_cost(x,y) - compute_cost(desired_x,desired_y)) - COST_STEP
    else:
        reward = -COST_STEP


    return reward

def get_nice_policy(states):
    policy = [None]*NUM_STATES

    for x in range(0,int((X_SIZE/2))):
        for y in range(Y_SIZE):
            policy[x + y*Y_SIZE] = 'S'

    for x in range(X_SIZE):
        for y in range(0,int((Y_SIZE/2))):
            policy[x + y * Y_SIZE] = 'E'

    for x in range(int((X_SIZE/2))+1,X_SIZE):
        for y in range(Y_SIZE):
            policy[x + y*Y_SIZE] = 'N'

    for x in range(int((X_SIZE/2)),X_SIZE):
        for y in range(int((Y_SIZE/2)+1),Y_SIZE):
            policy[x + y * Y_SIZE] = 'W'

    for x in range(X_SIZE):
        for y in range(Y_SIZE):
            if policy[x + y * Y_SIZE] == None:
                if states[x + y * Y_SIZE].end==False:
                    policy[x + y * Y_SIZE] = '·'



    return policy

def get_random_policy(states):

    policy= []

    for x in range(X_SIZE):
        for y in range(Y_SIZE):

            if(find_state(x,y,states).end==False):


                rand_dir = randint(0, 4)
                if rand_dir==0:
                    policy.append('N')
                if rand_dir==1:
                    policy.append('S')
                if rand_dir==2:
                    policy.append('W')
                if rand_dir==3:
                    policy.append('E')
                if rand_dir==4:
                    policy.append('·')




            else:
                policy.append(None)

    return policy

def get_fixed_random_policy(states):
    return ['S', 'N', 'S', '·', '·', 'N', 'S', '·', 'W', 'E', '·', 'S', '·', 'W', 'W', 'S', 'S', 'S', 'E', '·', 'E', 'E', 'W', '·', 'S', 'S', 'W', 'N', 'E', '·', 'N', '·', 'E', 'S', 'W', 'S', '·', 'N', 'W', '·', 'N', 'S', 'S', 'W', '·', 'S', '·', 'S', 'E']

def print_V(V):
    for i in range(X_SIZE):
        for j in range(Y_SIZE):
            print(str(i) + " " + str(j) + ": " + str(V[i + j * Y_SIZE]))

def print_policy(policy):
    print()
    for y in range(Y_SIZE - 1, -1, -1):
        for x in range(X_SIZE):

            if policy[x + y * Y_SIZE] != None:
                print(policy[x + y * Y_SIZE], end=" ")
            else:
                print(" ", end=" ")
        print()
    print()

def get_random_state(states):
    random_state = find_state(randint(0, X_SIZE - 1), randint(0, Y_SIZE - 1), states)
    while random_state.end == True:
        random_state = find_state(randint(0, X_SIZE - 1), randint(0, Y_SIZE - 1), states)
    return random_state

def print_wait_info(loop,number_of_iterations):
    if (loop % (number_of_iterations / 10) == 0 and loop != 0):
        print("|", end=' ')
        sys.stdout.flush()

def get_num_action(action):
    if(action=='N'):
        return 0
    if(action=='S'):
        return 1
    if(action=='W'):
        return 2
    if(action=='E'):
        return 3
    if(action=='·'):
        return 4

def get_action(action_num):
    if(action_num==0):
        return 'N'
    if(action_num==1):
        return 'S'
    if(action_num==2):
        return 'W'
    if(action_num==3):
        return 'E'
    if(action_num==4):
        return '·'

def argmax_a(Q,state):

    best_action = get_action(0)
    best_q = Q[0][state.x + state.y * Y_SIZE]

    if Q[1][state.x + state.y * Y_SIZE] > best_q:
        best_action = get_action(1)
        best_q = Q[1][state.x + state.y * Y_SIZE]

    if Q[2][state.x + state.y * Y_SIZE] > best_q:
        best_action = get_action(2)
        best_q = Q[2][state.x + state.y * Y_SIZE]

    if Q[3][state.x + state.y * Y_SIZE] > best_q:
        best_action = get_action(3)
        best_q = Q[3][state.x + state.y * Y_SIZE]

    if Q[4][state.x + state.y * Y_SIZE] > best_q:
        best_action = get_action(4)
        best_q = Q[4][state.x + state.y * Y_SIZE]

    return best_action

def max_a(Q,state):

    best_action = get_action(0)
    best_q = Q[0][state.x + state.y * Y_SIZE]

    if Q[1][state.x + state.y * Y_SIZE] > best_q:
        best_action = get_action(1)
        best_q = Q[1][state.x + state.y * Y_SIZE]

    if Q[2][state.x + state.y * Y_SIZE] > best_q:
        best_action = get_action(2)
        best_q = Q[2][state.x + state.y * Y_SIZE]

    if Q[3][state.x + state.y * Y_SIZE] > best_q:
        best_action = get_action(3)
        best_q = Q[3][state.x + state.y * Y_SIZE]

    if Q[4][state.x + state.y * Y_SIZE] > best_q:
        best_action = get_action(4)
        best_q = Q[4][state.x + state.y * Y_SIZE]

    return best_q




def main():

    states = []

    for x in range(X_SIZE):
        for y in range(Y_SIZE):

            if (x==OPTIMAL_X and y == OPTIMAL_Y):
                states.append(State(x,y,OPTIMAL_FINAL_STATE,compute_cost(x,y)))
            else:
                states.append(State(x, y, False,compute_cost(x,y)))


    #policy_example = get_nice_policy(states) # is simply a list of strings...
    policy_example = get_fixed_random_policy(states)  # is simply a list of strings...

    print_policy(policy_example)

    print("What do you want to do?:")

    option_selected = input()




    # MODEL-FREE MDP ALGO: Q-LEARNING, FIND [ESTIMATED] OPTIMAL POLICY
    if option_selected == "5":

        policy_actual = policy_example

        ALPHA = 0.001  # Which is the right value? After 50% of iteration decay... after 80% decay... LEARNING RATE...
        current_state = get_random_state(states)
        Q = []
        for i in range(NUM_ACTIONS):
            Q.append([0.0] * NUM_STATES)

        EPSILON = 1.00
        number_of_iterations = 5000000
        DECAYING_EPSILON = 1.0/number_of_iterations

        for t in range(number_of_iterations):

            print_wait_info(t, number_of_iterations)

            action = policy_actual[current_state.x + current_state.y * Y_SIZE]
            next_state = current_state.next_state(action, states)
            reward = current_state.cost - next_state.cost

            Q_t_minus_1 = Q[get_num_action(action)][current_state.x + current_state.y * Y_SIZE]

            if t%(number_of_iterations/10)== 0 and t!=0:
                ALPHA= ALPHA/2

            Q[get_num_action(action)][current_state.x + current_state.y *Y_SIZE] = Q_t_minus_1 + ALPHA * (reward + GAMMA * max_a(Q, next_state) - Q_t_minus_1)

            policy_actual[current_state.x + current_state.y * Y_SIZE] = argmax_a(Q, current_state)
            random_int = randint(0, 99)
            if random_int < int(EPSILON * 100):
                policy_actual[current_state.x + current_state.y * Y_SIZE] = get_action(randint(0, 4))

            EPSILON= EPSILON - DECAYING_EPSILON

            #current_state = next_state
            current_state= get_random_state(states)

        print_policy(policy_actual)









    # Suposant que no ens donen les probabilitats, com trobes V de una policy pi?: TD learning... Osigui model free es com RL ja no...? CLAU...

    # After TD learning, Q learning...

    # potser podria usar threads per usar diferents CPU's...
    # mes endavant -> imagina que les transition probabilities cambiessin through time... que en el fons es el que passa al autoscaling problem...

    # l'ultim montecarlo esta bé perque aconsegueix estimator of V que es unbiased!! tot i que es veu que la variance es bastant gran...

    ## THEORY ##
    # It would be nice to undestand why DP policy evaluation algo. works... is because you are using bootstrapping...
    # It's much easier to understand MC policy evaluation algo. works... it relies on sampling, not on bootstrapping...

if __name__ == '__main__':
    main2()